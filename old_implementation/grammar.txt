line_
    : line EOL

line
    | BITS NUM
    | lbl 
    | inst

lbl
    : LABEL COLON

inst
    : mnemonic_ operand_ COMMA operand_
    | mnemonic_ operand_
    | mnemonic_

mnemonic_
    : prefix* mnemonic

operand_
    : opr_prefix* operand

opr_prefix
    : opr_size
    | seg_ovr

seg_ovr
    : reg_seg COLON

operand
    : reg_gen
    | eaddr__
    | reg_seg
    | imm

imm
    : opr_math? (NUM | NUM_ZERO)

prefix
    : LOCK
    | REP
    | REPE
    | REPNE
    | REPZ
    | REPNZ

eaddr__
    : LSQUARE_BR eaddr_ RSQUARE_BR

eaddr_
    : (PLUS)? eaddr

eaddr
    : reg_base PLUS reg_idx signed_num?
    | reg_base              signed_num?
    |               reg_idx signed_num?
    | reg_base PLUS reg_idx signed_zero?
    | reg_base              signed_zero?
    |               reg_idx signed_zero?
    | direct_addr

direct_addr
    : opr_math? (NUM|NUM_ZERO)

signed_num
    : opr_math NUM

signed_zero
    : opr_math NUM_ZERO

mnemonic
    : MOV
    | PUSH
    | POP

reg_base
    : BX | BP

reg_idx
    : SI | DI

reg_gen
    : AX | AL | AH | BX | BL | BH | CX | CL | CH | DX | DL | DH | SP | BP | SI | DI

reg_seg
    : CS | DS | SS | ES

opr_math
    : PLUS | MINUS

opr_size
    : BYTE | WORD

